## 项目目标

我现在需要做一个自动发送邮件的助手，我用的是gmail。我需要有脚本和接口调用两种使用方式。

## API接口文档

@

## 具体的功能

1. 用户输入从什么邮箱发出（from），然后检测这个邮箱是否有.json文件，如果没有则需要认证。认证之后json文件以这个邮箱名为文件名。这样就可以以邮箱名作为检测字段。

2. 用户传入excel文件，然后字段必须包含以下字段："邮箱"、“合作次数”、“回复次数”、“跟进次数”、“跟进方式”、“是否已邮箱建联”。
   - 表格筛选条件：“邮箱”!=NULL&“合作次数”==0&“回复次数”==0&“跟进次数”==1&“跟进方式”!="手动"

3. 用户选择传入邮箱开始运行的时间

4. 用户选择没封邮箱最大的等待间隔时间，默认90秒

5. 根据数据表中的“邮箱”字段依次发送邮件，每封邮件在20秒至用户指定最大的等待时间之间随机等待

6. 如果发送成功则将“是否已邮箱建联”设为1，失败则设为-1。直接修改excel表格的字段，这样用户可以通过表格看到哪些发送成功，哪些没发送成功



## 新增需求

***支持content、html_content和subject在语言和内容上的自定义***。传入的文件会增加一列”语言“的列，同时用户会在template/存放不同语言的模板，前缀是语言的简写。English对应en，Spanish对应esp。如果没有找到对应的模板则使用en的模板，比如”语言“是French，但是模板没有fr为开头的模板，则使用en的模板

### subject自定义

每封邮件的”subject“支持自定义，用户在template/文件下的[]-subject文件中设置好模板，然后模板可以自定义参数。

例如：
Loved your [某条视频内容总结] video and a partnership idea!
那么用户传入的文件中，一定会包含"某条视频内容总结"这一列，程序从这一列的数据去获取数据填充
如果用户传入的文件中没有"某条视频内容总结"这一列，则应该要有相应的提示和日志记录

”subject“文件有多个语言版本，比如"en-subject"对应语言English，"esp-subject"对应语言Spanish。如果找不到语言对应的subject文件则默认用en的版本

### html_content自定义

每封邮件的”html_content“支持自定义，用户在template/文件下的[]-html_content文件中设置好模板，然后模板可以自定义参数。

例如：
Hi [达人ID],
[钩子]
I’m Erica, founder of Swipe Up US (Outdoor Living & Essentials). We’ve just launched a multifunctional flashlight, recently ranked 
那么用户传入的文件中，一定会包含"[达人ID]"和"[钩子]"这两列，程序从这两列的数据去获取数据填充
如果用户传入的文件中没有"[达人ID]"和"[钩子]"这两列，则应该要有相应的提示和日志记录

”html_content“文件有多个语言版本，比如"en-html_content"对应语言English，"esp-html_content"对应语言Spanish。如果找不到语言对应的html_content文件则默认用en的版本

### content自定义

程序自动从对应的[]-html_content文件中解析文本，将html_content转换为content内容



## 发送图片需求

在邮件中插入图片是一个很常见的需求，项目应该要有发送图片的功能。用户会将图片放在files/pics目录下。
在html_content下触发发送图片的标识是看到"<img />"这个标识，图片的ID为图片文件名。也就是html_content中图片的id指向files/pics下的某张以ID为命名的图片



## 发送附件需求

在邮件中插入附件是一个很常见的需求，请检查项目中是否包含发送附件的功能，如果没有请增加。用户会将文件放在files下，如果文件也需要id，那么也是以文件名为id名。新增一个文件参数，这个参数是一个列表。默认为空，当为空时则这封邮件没有包含附件，如果不为空时则按照列表里面的文件路径添加附件