# ========================================
# Email Assistant 环境变量配置示例
# ========================================
# 复制此文件为 .env 并根据实际情况修改配置值

# ========================================
# 数据库配置（必需）
# ========================================
# MySQL 数据库连接字符串
# 格式：mysql+pymysql://用户名:密码@主机:端口/数据库名?charset=utf8mb4

# 示例1：使用外部 MySQL 服务器（推荐生产环境）
DATABASE_URL=mysql+pymysql://influzzde_user:your_password@192.168.1.100:3306/influzzde_db?charset=utf8mb4

# 示例2：使用 Docker 内置 MySQL（需要在 docker-compose.yml 中添加 MySQL 服务）
# DATABASE_URL=mysql+pymysql://influzzde_user:your_password@mysql:3306/influzzde_db?charset=utf8mb4

# ========================================
# API 认证配置（必需）
# ========================================
# API 密钥，用于保护写接口（POST/PUT/DELETE）
# 调用这些接口时需要在请求头中携带：X-API-Key: your_api_key_here
API_KEY=your_secure_api_key_change_me_in_production

# ========================================
# Google OAuth 配置（必需）
# ========================================
# OAuth 授权流程类型
# web: 服务端授权（生产环境）
# desktop: 本地桌面授权（本地开发）
AUTH_FLOW=web

# Google OAuth 客户端凭证文件路径
# Docker 环境：使用容器内路径（已通过 volume 挂载）
GOOGLE_OAUTH_CLIENT_JSON=/secrets/credentials.json
# 本地开发：使用相对路径
# GOOGLE_OAUTH_CLIENT_JSON=credentials.json

# OAuth 重定向 URL（必须与 Google Cloud Console 中配置完全一致）
# 格式：https://你的域名/email-assistant/oauth/google/callback
OAUTH_REDIRECT_URL=https://influzzde.top/email-assistant/oauth/google/callback

# ========================================
# 文件存储配置（必需）
# ========================================
# 文件存储根目录（附件、图片等）
# Docker 环境：使用容器内路径（已通过 volume 挂载）
FILES_ROOT=/data/files
# 本地开发：使用绝对路径
# FILES_ROOT=D:\\Email Assistant\\files

# ========================================
# OAuth 回调安全配置（必需）
# ========================================
# 允许的回调 URL 主机白名单（逗号分隔）
# 支持精确匹配和后缀匹配（以点开头）
# 例如：influzzde.top,.influzzde.top 表示允许 influzzde.top 及其所有子域名
ALLOWED_RETURN_URL_HOSTS=influzzde.top,.influzzde.top

# 默认回调 URL（当客户端未提供或提供的 URL 不在白名单时使用）
DEFAULT_RETURN_URL=https://influzzde.top/email-assistant/

# 是否允许 localhost/127.0.0.1 作为回调 URL（仅用于本地开发）
# 生产环境必须设置为 false
ALLOW_DEV_LOCALHOST=false

# ========================================
# 加密配置（可选）
# ========================================
# 数据加密密钥（当前保留，暂未使用）
ENCRYPTION_KEY=

# ========================================
# 配置说明
# ========================================
#
# 1. Google OAuth 凭证获取步骤：
#    - 访问 https://console.cloud.google.com/
#    - 创建或选择项目
#    - 启用 Gmail API
#    - 创建 OAuth 2.0 客户端 ID（选择"Web 应用"）
#    - 添加授权重定向 URI：https://你的域名/email-assistant/oauth/google/callback
#    - 下载客户端凭证 JSON 文件（命名为 credentials.json）
#    - 将文件上传到服务器的 email-assistant/secrets/ 目录
#
# 2. 数据库初始化：
#    - 在 MySQL 中创建数据库：CREATE DATABASE influzzde_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
#    - 创建用户并授权：CREATE USER 'influzzde_user'@'%' IDENTIFIED BY 'password';
#    - 授予权限：GRANT ALL PRIVILEGES ON influzzde_db.* TO 'influzzde_user'@'%';
#    - 导入表结构：执行 DB/ 目录下的所有 .sql 文件
#
# 3. 安全建议：
#    - 使用强密码（至少包含大小写字母、数字、特殊字符）
#    - 不要将 .env 文件提交到版本控制系统（已在 .gitignore 中）
#    - 定期更新 API_KEY
#    - 生产环境务必设置 ALLOW_DEV_LOCALHOST=false
